---
title: "Regression Model Project"
author: "Ziwen Yu"
date: "Monday, April 20, 2015"
output: pdf_document
---

## Executive Summary

```{r Environment,message=FALSE}
libs=c('ggplot2','scales')
lapply(libs,library, character.only=T)
# Plot style
Plot_theme = theme_bw()+
      theme(plot.title = element_text(size = 12)
            ,axis.title.x = element_text(size=10)
            ,axis.title.y = element_text(size=10)
            ,axis.text.x = element_text(size=8,angle = 45, hjust = 1)
            ,axis.text.y = element_text(size=8)            
      )
# Load Data
data(mtcars)
mtcars$cyl <- as.factor(mtcars$cyl)
mtcars$vs <- as.factor(mtcars$vs)
mtcars$am <- factor(mtcars$am)
mtcars$gear <- factor(mtcars$gear)
mtcars$carb <- factor(mtcars$carb)
```

## Exploratory Analysis
```{r MPG Distribution by Transimission}
ggplot(data=mtcars)+
  geom_boxplot(aes(factor(am),mpg))+
  labs(x='Transmission (0: Automatic, 1: Manual)')+
  Plot_theme
```

MPG distribution of two transmissions

## Statistical Inference
T test of mean MPGs between automatic and manual transmission
null hypothesis: mean MPGs of automatic and manual transmissions are equal.
```{r T test for mean MPGs}
MPGmuTest=with(mtcars,t.test(mpg~am))
MPGmuTest$p.value
```



## Regression models
### all variables
null hypothesis: all coeffificent equal 0.
```{r full model}
fullmodel=lm(mpg~.,data=mtcars)
summary(fullmodel)
```
P value is 0.000124, much less than alpha=0.5. null hypothesis is rejected. 

### selected variables
```{r AIC selection}
sltVarmodel=step(fullmodel)
```
Only cyl, hp, wt and am variable are picked based on AIC value.

### correlated variables
```{r pair plot for selected variable}
pairs(mtcars[,c('cyl','hp','wt','am')],panel=panel.smooth,main='Pair Graph of Selected Model Variables')
```
may have interaction between wt and hp. Add interactive variable wt*hp into model
```{r interaction variable model}
intactmodel=lm(mpg~cyl + hp + wt + am+wt*hp,data=mtcars)
```

### easiest model
null hypothesis: the coefficient of interactive variable wt*qsec equals 0
```{r anova to estimate the interactive variable}
anova(sltVarmodel,intactmodel)
```
P value is 0.035 which is significant to reject the null hypothesis on 5% level . The interactive variable should be inclued in the regression model.

### residual analysis
```{r residual plot}
par(mfrow = c(2, 2))
plot(intactmodel)
```

## Conclusion

## Appendix
